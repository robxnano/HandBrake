{
    "app-id": "fr.handbrake.ghb.Plugin.IntelMediaSDK",
    "branch": "2",
    "runtime": "fr.handbrake.ghb",
    "runtime-version": "development",
    "sdk": "org.gnome.Sdk//48",
    "build-extension": true,
    "separate-locales": false,
    "modules": [
        {
            "name": "mediasdk",
            "buildsystem": "cmake-ninja",
            "builddir": true,
            "config-opts": [
                "-DCMAKE_POLICY_VERSION_MINIMUM=3.10",
                "-DCMAKE_BUILD_TYPE=Release",
                "-DCMAKE_INSTALL_LIBDIR=lib",
                "-DBUILD_SAMPLES=OFF",
                "-DBUILD_TESTS=OFF",
                "-DBUILD_TOOLS=OFF",
                "-DBUILD_TESTS=OFF",
                "-DMFX_ENABLE_SW_FALLBACK=OFF"
            ],
            "build-options": {
                "prefix" : "/app/extensions/IntelMediaSDK",
                "strip": true
            },
            "post-install": [
                "install -Dp -m 644 ${FLATPAK_BUILDER_BUILDDIR}/fr.handbrake.ghb.Plugin.IntelMediaSDK.metainfo.xml --target-directory=${FLATPAK_DEST}/share/metainfo"
            ],
            "sources": [
                {
                    "type": "archive",
                    "url": "https://github.com/Intel-Media-SDK/MediaSDK/archive/refs/tags/intel-mediasdk-22.6.5.tar.gz",
                    "sha256": "3a671cc692da5111c041088f5e32528b4346e122e8a134fad71310c572705106"
                },
                {
                    "type": "patch",
                    "path": "intel-mediasdk-gcc13.patch"
                },
                {
                    "type": "file",
                    "path": "fr.handbrake.ghb.Plugin.IntelMediaSDK.metainfo.xml"
                }
            ],
            "cleanup": [
                "/include",
                "/lib/pkgconfig",
                "/lib/*.a",
                "/lib/*.la",
                "/lib/*.so"
            ]
        },
        {
            "name": "onevpl-intel-gpu",
            "buildsystem": "cmake-ninja",
            "builddir": true,
            "config-opts": [
                "-DCMAKE_BUILD_TYPE=Release",
                "-DCMAKE_INSTALL_LIBDIR=lib"
            ],
            "build-options": {
                "prefix" : "/app/extensions/IntelMediaSDK",
                "strip": true
            },
            "sources": [
                {
                    "type": "archive",
                    "url": "https://github.com/intel/vpl-gpu-rt/archive/refs/tags/intel-onevpl-25.2.6.tar.gz",
                    "sha256": "d236ede2ab87063d0d8d52932779ff446a885b8dc4ef840d1a756c6776ef6fef"
                }
            ],
            "cleanup": [
                "/include",
                "/lib/pkgconfig",
                "/lib/*.a",
                "/lib/*.la",
                "/lib/*.so"
            ]
        }
    ]
}
